{% extends "base.html" %}

{% block title %}Our Parents - Tucson Golden Doodles{% endblock %}

{% block content %}
<div class="container-fluid p-0"> {# Use container-fluid for full width sections #}

    {% if parents %}
        {% for parent in parents %}
        {# Name Banner #}
        <div class="parent-name-banner" style="background-color: #79868f;"> {# Muted background bar #}
            <h1 class="display-5 text-white text-uppercase text-center py-3">{{ parent.name }}</h1> {# Large, all-caps serif, white, centered #}
        </div>

        <div class="container my-5"> {# Container for the two-column layout #}
            <div class="row g-4 parent-layout-container"> {# g-4 for consistent spacing #}

                {# Left Column: Main Image, Alternate Images, Buttons #}
                <div class="col-md-6 parent-image-column">
                    <div class="main-image-wrapper p-2"> {# Added padding #}
                        <img src="{{ parent.main_image_url }}" class="img-fluid parent-main-image" alt="Main photo of {{ parent.name }}">
                    </div>

                    {# Alternate Image Thumbnails #}
                    {% set alternate_images = [
                        parent.alternate_image_url_1,
                        parent.alternate_image_url_2,
                        parent.alternate_image_url_3,
                        parent.alternate_image_url_4
                    ] %}
                    {% set has_alternate_images = false %}
                    {% for img in alternate_images %}{% if img %}{% set has_alternate_images = true %}{% endif %}{% endfor %}

                    {% if has_alternate_images %}
                    <div class="mt-4 px-2"> {# Slight padding for alignment #}
                        <h6>Alternate Views</h6>
                        <div class="row row-cols-3 row-cols-lg-4 g-2 justify-content-center alternate-thumbnails-grid">
                            {% for img_url in alternate_images %}
                                {% if img_url %}
                                <div class="col">
                                    <a href="{{ img_url }}" data-toggle="lightbox" data-gallery="alternate-gallery-{{ parent.id }}" data-title="{{ parent.name }} Alternate View">
                                        <img src="{{ img_url }}" class="img-thumbnail parent-alternate-image" alt="{{ parent.name }} Alternate Image">
                                    </a>
                                </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </div>

                {# Right Column: Breed & Weight, Description #}
                <div class="col-md-6 parent-info-column">
                    <div class="text-center mt-md-0 mt-4"> {# Align with top of main image on desktop, add top margin on mobile #}
                        <h3 class="breed-header">{{ parent.breed }}</h3>
                        <p class="weight-header">
                            {% if parent.weight_kg is not none %}
                                {{ parent.weight_kg }} kg / {{ (parent.weight_kg * 2.20462)|round(1) }} lbs
                            {% else %}
                                Weight: N/A
                            {% endif %}
                        </p>
                    </div>
                    <div class="description-paragraphs mt-4">
                        {# Split description by newlines to create paragraphs #}
                        {% for paragraph in parent.description.split('\n') %}
                            {% if paragraph.strip() %}
                                <p class="text-justify">{{ paragraph.strip() }}</p> {# Justified text #}
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
            </div> {# End .row #}

            {# "Past Puppies" Section Header #}
            {% if parent.grouped_litters %}
            <div class="past-puppies-header mt-5 text-center">
                <h2>{{ parent.name | upper }}'S PAST PUPPIES</h2> {# All-caps or small-caps #}
            </div>

            {# Past Puppies Thumbnails Row - Horizontal Scroll #}
            <div class="past-puppies-thumbnails-row mt-4">
                <div class="d-flex flex-nowrap overflow-auto py-2"> {# Flexbox for horizontal scroll #}
                    {% for (birth_date, dad, mom), puppies in parent.grouped_litters.items() %}
                        {% for puppy in puppies %}
                        <div class="p-2 flex-shrink-0 puppy-thumbnail-wrapper">
                            <a href="{{ url_for('puppies.list_puppies') }}#litter-{{ puppy.birth_date.strftime('%Y%m%d') }}-{{ puppy.dad.id }}-{{ puppy.mom.id }}" title="{{ puppy.name }} ({{ puppy.status.value }})">
                                <img src="{{ puppy.main_image_url }}" class="img-fluid puppy-thumbnail" alt="Photo of {{ puppy.name }}">
                            </a>
                        </div>
                        {% endfor %}
                    {% endfor %}
                </div>
            </div>
            {% endif %}

        </div> {# End .container #}
        {% endfor %}
    {% else %}
        <div class="container my-5">
            <div class="alert alert-info text-center" role="alert">
                There are no parent dogs to display at this time. Please check back later!
            </div>
        </div>
    {% endif %}

</div> {# End container-fluid #}
{% endblock %}

{% block extra_js %}
{# This script enables the image gallery lightbox functionality #}
<script src="https://cdn.jsdelivr.net/npm/bs5-lightbox@1.8.3/dist/index.bundle.min.js"></script>
{% endblock %}