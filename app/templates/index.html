{% extends "base.html" %}

{% block content %}

{% if hero %}
{# --- MODIFIED: Use s3_url filter for background image --- #}
<section class="hero-section" style="background-image: url('{{ (hero.image_s3_key_large or hero.image_s3_key) | s3_url }}');">
    </section>
{% endif %}

<div class="container" id="about">
    {% if about %}
    <section class="my-5">
        <div class="row align-items-center">
            <div class="col-md-6">
                {# --- MODIFIED: Use s3_url filter for about image --- #}
                <img src="{{ about.image_s3_key | s3_url }}" class="img-fluid rounded shadow" alt="About us">
            </div>
            <div class="col-md-6">
                <h2 class="display-5">{{ about.title }}</h2>
                <div class="lead">{{ about.content_html|safe }}</div>
            </div>
        </div>
    </section>
    <hr class="my-5">
    {% endif %}

    <section id="available-puppies" class="my-5 text-center">
        <h2 class="display-5 mb-4">Available Puppies</h2>
        {% if puppies %}
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            {% for puppy in puppies %}
            <div class="col">
                <div class="card h-100 shadow-sm">
                    {# --- MODIFIED: Use s3_url filter --- #}
                    <img src="{{ puppy.main_image_s3_key | s3_url }}" class="card-img-top" alt="Photo of {{ puppy.name }}">
                    <div class="card-body">
                        </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        {% endif %}
    </section>
    <hr class="my-5">

    {% if guardian_parents %}
    <section id="guardian-parents" class="my-5 text-center">
        <h2 class="display-5 mb-4">Guardian Parents</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            {% for parent in guardian_parents %}
            <div class="col">
                <div class="card h-100 shadow-sm">
                    {# --- MODIFIED: Use s3_url filter --- #}
                    <img src="{{ parent.main_image_s3_key | s3_url }}" class="card-img-top" alt="Photo of {{ parent.name }}">
                    <div class="card-body">
                        </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    <hr class="my-5">
    {% endif %}

    {% if gallery_images %}
    <section id="gallery" class="my-5">
        <h2 class="display-5 text-center mb-4">Gallery</h2>
        <div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 g-3">
            {% for image in gallery_images %}
            <div class="col">
                {# --- MODIFIED: Use s3_url filter for both href and src --- #}
                <a href="{{ image.image_s3_key | s3_url }}" data-toggle="lightbox" data-gallery="site-gallery" data-title="{{ image.caption or 'Gallery Image' }}">
                    <img src="{{ image.image_s3_key | s3_url }}" class="img-fluid img-thumbnail" alt="{{ image.caption or 'Gallery Image' }}">
                </a>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

</div>
{% endblock %}